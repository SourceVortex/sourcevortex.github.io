{"componentChunkName":"component---src-templates-blog-template-tsx","path":"/blog/2020/08/routing-controllers","result":{"data":{"markdownRemark":{"html":"<h3 id=\"rotas-do-jeito-tradicional\" style=\"position:relative;\"><a href=\"#rotas-do-jeito-tradicional\" aria-label=\"rotas do jeito tradicional permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rotas do jeito \"tradicional\"</h3>\n<p>Normalmente em aplicações construídas com ExpressJS precisamos criar um arquivo (ou arquivos) para definir as rotas, por exemplo:</p>\n<div class=\"gatsby-code-title md-code-title\">routes/userRouter.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> userController <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../controllers/userController'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> express<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nrouter\n  <span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>userController<span class=\"token punctuation\">.</span>getAllUsers<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>userController<span class=\"token punctuation\">.</span>createUser<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p>Neste exemplo as rotas de usuários possui um arquivo próprio e se utiliza do <strong>userController</strong> e seus métodos, e conforme essa aplicação crescer, mais arquivos de rotas e controllers serão criados para cada módulo, ou seja, dois arquivos para cada módulo.</p>\n<p>Porém, um padrão muito utilizado em alguns <strong><em>frameworks</em></strong> é usar apenas o arquivo de <strong><em>controller</em></strong> para definir as rotas, e isso é possível através de <strong><em>annotations</em></strong> ou <strong><em>decorators</em></strong>.</p>\n<h2 id=\"annotationsdecorators\" style=\"position:relative;\"><a href=\"#annotationsdecorators\" aria-label=\"annotationsdecorators permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Annotations/Decorators</h2>\n<p>De uma forma geral, esse recurso consiste em adicionar em seu código uma sintaxe que \"intercepta\" um método ou classe para manipular seu comportamento. Para utilizarmos esse recurso no ExpressJS precisamos usar <strong><em>typescript</em></strong> e habilitar o uso de <strong><em>decorators</em></strong> no arquivo <code class=\"language-text\">tsconfig.json</code>, desta forma:</p>\n<div class=\"gatsby-code-title md-code-title\">tsconfig.json</div>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    \"compilerOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// ...</span>\n      <span class=\"token property\">\"experimentalDecorators\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n      <span class=\"token property\">\"emitDecoratorMetadata\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n      <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Além disso vamos precisar instalar uma biblioteca chamada <strong><em>Routing Controllers</em></strong>.</p>\n<h3 id=\"routing-controllers\" style=\"position:relative;\"><a href=\"#routing-controllers\" aria-label=\"routing controllers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Routing Controllers</h3>\n<p>A biblioteca <a href=\"https://github.com/typestack/routing-controllers\">routing controllers</a> permite usarmos diversos <strong><em>decorators</em></strong> já prontos para implementar o sistema de roteamento de nossa aplicação. Não só isso, mas é possível utilizá-la para validações dos objetos enviados nas requisições, mas falaremos disso em um outro momento.</p>\n<p>Enquanto da forma \"tradicional\" precisávamos de pelo menos dois arquivos por módulo, agora podemos ter apenas um. Seguindo o exemplo anterior, porém usando essa biblioteca nós teríamos algo assim:</p>\n<div class=\"gatsby-code-title md-code-title\">controllers/UserController.ts</div>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Request<span class=\"token punctuation\">,</span> Response <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'express'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> JsonController<span class=\"token punctuation\">,</span> Post<span class=\"token punctuation\">,</span> Get <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'routing-controllers'</span>\n\n@<span class=\"token function\">JsonController</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/users'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UserController</span> <span class=\"token punctuation\">{</span>\n  @<span class=\"token function\">Post</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  @<span class=\"token function\">Get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Viu, que simples?! O decorator <strong>@JsonController</strong> usado acima da classe determina o prefixo de todas as rotas do arquivo, enquanto o <strong>@Post</strong> e <strong>@Get</strong> representa os verbos HTTP (podem conter também sufixos caso necessário).</p>\n<p>Caso tenha interesse no processo de configuração e queira um exemplo mais completo, confira <a href=\"https://github.com/sourcevortex/express-template\">esse template</a> onde foi utilizado esse padrão juntamento com MongoDB.</p>","frontmatter":{"file":"/blob/master/_posts/2020/08/routing-controllers.md","date":"2020-08-02 12:10:00","slug":"/blog/2020/08/routing-controllers","title":"Routing Controllers","excerpt":null,"image":"2020/08/routing-controller.png","imageAlt":"ElectronJS template image","tags":["Typescript","ExpressJS","Node.JS"],"badgeColors":["white","black","white"],"badgeBackgrounds":["#294e80","#efd81d","#026e00"]}}},"pageContext":{"slug":"/blog/2020/08/routing-controllers"}}}